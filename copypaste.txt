from flask import Flask, jsonify, request
import requests
import os

app = Flask(__name__)
API_KEY = os.environ["POLYGON_API_KEY"]

@app.route("/quote/<symbol>")
def quote(symbol):
    try:
        url = f"https://api.polygon.io/v2/last/trade/{symbol.upper()}?apiKey={API_KEY}"
        response = requests.get(url)
        return jsonify(response.json())
    except Exception as e:
        return jsonify({"error": str(e)}), 500

@app.route("/options/<symbol>")
def options(symbol):
    try:
        url = f"https://api.polygon.io/v3/snapshot/options/{symbol.upper()}?apiKey={API_KEY}"
        response = requests.get(url)
        return jsonify(response.json())
    except Exception as e:
        return jsonify({"error": str(e)}), 500

if __name__ == "__main__":
    app.run(debug=True)